<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>臺灣銀行 ATM 介面改版回饋問卷</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="container">
        <header>
            <img src="assets/logo.png" alt="Bank of Taiwan Logo" class="logo">
            <h1>ATM 介面改版回饋問卷</h1>
            <div class="deadline-badge">2/23 截止</div>
        </header>

        <section class="landing-page" id="landing-page">
            <div class="landing-top">
                <div class="highlight-banner">
                    <p class="highlight-title">改版三大亮點</p>
                    <ul class="highlight-list">
                        <li><span>❶</span> 視覺改版，延展臺銀精神</li>
                        <li><span>❷</span> 流程簡化，操作流暢簡單</li>
                        <li><span>❸</span> 資訊清楚，理解更為容易</li>
                    </ul>
                </div>
                <div class="landing-image">
                    <img src="assets/ATMImage.png" alt="ATM Screen" class="atm-screen">
                </div>
            </div>
            <div class="landing-bottom">
                <div class="mascot-block">
                    <img src="assets/BUBI.png" alt="Whale mascot and QR code" class="mascot-full">
                </div>
                <div class="promo-block">
                    <h2 class="promo-title">只要 5 分鐘，完成即抽豐富大獎！</h2>
                    <div class="promo-list">
                        <div class="promo-item">
                            <p>100 元超商禮券</p>
                            <p>40 名</p>
                        </div>
                        <div class="promo-item">
                            <p>1000 元超商禮券</p>
                            <p>20 名</p>
                        </div>
                    </div>
                    <button type="button" class="submit-btn" id="start-survey-btn">開始填寫</button>
                </div>
            </div>
        </section>

        <form class="survey-section hidden" id="survey-form">
            <!-- Question 1 -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">1.</span>
                    <span class="question-title">滿分十分，我會給這次改版幾分？</span>
                </div>
                <div class="rating-scale">
                    <input type="hidden" name="rating" value="">
                    <div class="rating-item" data-value="1">1 分</div>
                    <div class="rating-item" data-value="2">2 分</div>
                    <div class="rating-item" data-value="3">3 分</div>
                    <div class="rating-item" data-value="4">4 分</div>
                    <div class="rating-item" data-value="5">5 分</div>
                    <div class="rating-item" data-value="6">6 分</div>
                    <div class="rating-item" data-value="7">7 分</div>
                    <div class="rating-item" data-value="8">8 分</div>
                    <div class="rating-item" data-value="9">9 分</div>
                    <div class="rating-item" data-value="10">10 分</div>
                </div>
                <div class="error-message hidden">
                    <img src="assets/warning_icon.svg" alt="Warning">
                    <span>這題忘記填嚕 (•ᴥ•)</span>
                </div>
            </div>

            <!-- Question 2 -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">2.</span>
                    <span class="question-title">新版 ATM 看起來容易使用</span>
                </div>
                <div class="choice-list horizontal">
                    <input type="hidden" name="easy_to_use" value="">
                    <div class="choice-item" data-value="非常不同意">非常不同意</div>
                    <div class="choice-item" data-value="不同意">不同意</div>
                    <div class="choice-item" data-value="普通">普通</div>
                    <div class="choice-item" data-value="同意">同意</div>
                    <div class="choice-item" data-value="非常同意">非常同意</div>
                </div>
                <div class="error-message hidden">
                    <img src="assets/warning_icon.svg" alt="Warning">
                    <span>這題忘記填嚕 (•ᴥ•)</span>
                </div>
            </div>

            <!-- Question 3 -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">3.</span>
                    <span class="question-title">新版 ATM 的提款、轉帳、存款流程，可以滿足我的使用需求</span>
                </div>
                <div class="choice-list horizontal">
                    <input type="hidden" name="satisfaction_process" value="">
                    <div class="choice-item" data-value="非常不同意">非常不同意</div>
                    <div class="choice-item" data-value="不同意">不同意</div>
                    <div class="choice-item" data-value="普通">普通</div>
                    <div class="choice-item" data-value="同意">同意</div>
                    <div class="choice-item" data-value="非常同意">非常同意</div>
                </div>
                <div class="error-message hidden">
                    <img src="assets/warning_icon.svg" alt="Warning">
                    <span>這題忘記填嚕 (•ᴥ•)</span>
                </div>
            </div>

            <!-- Question 4 -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">4.</span>
                    <span class="question-title">我認為新版的 ATM 畫面比以往更加簡潔且現代化</span>
                </div>
                <div class="choice-list horizontal">
                    <input type="hidden" name="modernization" value="">
                    <div class="choice-item" data-value="非常不同意">非常不同意</div>
                    <div class="choice-item" data-value="不同意">不同意</div>
                    <div class="choice-item" data-value="普通">普通</div>
                    <div class="choice-item" data-value="同意">同意</div>
                    <div class="choice-item" data-value="非常同意">非常同意</div>
                </div>
                <div class="error-message hidden">
                    <img src="assets/warning_icon.svg" alt="Warning">
                    <span>這題忘記填嚕 (•ᴥ•)</span>
                </div>
            </div>

            <!-- Question 5 -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">5.</span>
                    <span class="question-title">下列項目中，我最有印象、最滿意的是（複選，最多三項）</span>
                </div>
                <div class="checkbox-list">
                    <label class="checkbox-item"><input type="checkbox" name="satisfied_features" value="整體視覺介面風格改版">
                        整體視覺介面風格改版</label>
                    <label class="checkbox-item"><input type="checkbox" name="satisfied_features"
                            value="操作步驟具流程性的標題清晰簡化"> 操作步驟具流程性的標題清晰簡化</label>
                    <label class="checkbox-item"><input type="checkbox" name="satisfied_features"
                            value="待機頁面地可提前查看廣告資訊"> 待機頁面地可提前查看廣告資訊</label>
                    <label class="checkbox-item"><input type="checkbox" name="satisfied_features"
                            value="交易結果頁面及交易流程可直接查看可用餘額"> 交易結果頁面及交易流程可直接查看可用餘額</label>
                    <label class="checkbox-item"><input type="checkbox" name="satisfied_features"
                            value="輸入帳號、金額時，可使用螢幕虛擬鍵盤"> 輸入帳號、金額時，可使用螢幕虛擬鍵盤</label>
                    <label class="checkbox-item"><input type="checkbox" name="satisfied_features" value="交易結果頁可依需求隱藏餘額">
                        交易結果頁可依需求隱藏餘額</label>
                    <label class="checkbox-item"><input type="checkbox" name="satisfied_features" value="轉帳流程可直接查詢銀行代碼">
                        轉帳流程可直接查詢銀行代碼</label>
                </div>
                <div class="error-message hidden">
                    <img src="assets/warning_icon.svg" alt="Warning">
                    <span>這題忘記填嚕 (•ᴥ•)</span>
                </div>
            </div>

            <!-- Question 6 -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">6.</span>
                    <span class="question-title">新版 ATM 整體的交易步驟比以往更精簡</span>
                </div>
                <div class="choice-list horizontal">
                    <input type="hidden" name="process_streamlining" value="">
                    <div class="choice-item" data-value="非常不同意">非常不同意</div>
                    <div class="choice-item" data-value="不同意">不同意</div>
                    <div class="choice-item" data-value="普通">普通</div>
                    <div class="choice-item" data-value="同意">同意</div>
                    <div class="choice-item" data-value="非常同意">非常同意</div>
                </div>
                <div class="error-message hidden">
                    <img src="assets/warning_icon.svg" alt="Warning">
                    <span>這題忘記填嚕 (•ᴥ•)</span>
                </div>
            </div>

            <!-- Question 7 -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">7.</span>
                    <span class="question-title">新版 ATM 續顯可以提前掌握機台所提供的服務與狀態（如：可受理面額、語音模式等）</span>
                </div>
                <div class="image-placeholder-box">
                    <img src="assets/q7_screen.png" alt="Display Screen" class="img-responsive">
                </div>
                <div class="choice-list horizontal">
                    <input type="hidden" name="info_mastery" value="">
                    <div class="choice-item" data-value="非常不同意">非常不同意</div>
                    <div class="choice-item" data-value="不同意">不同意</div>
                    <div class="choice-item" data-value="普通">普通</div>
                    <div class="choice-item" data-value="同意">同意</div>
                    <div class="choice-item" data-value="非常同意">非常同意</div>
                </div>
                <div class="error-message hidden">
                    <img src="assets/warning_icon.svg" alt="Warning">
                    <span>這題忘記填嚕 (•ᴥ•)</span>
                </div>
            </div>

            <!-- Question 8 -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">8.</span>
                    <span class="question-title">新版 ATM 看起來不需重新學習也可以完成交易</span>
                </div>
                <div class="choice-list horizontal">
                    <input type="hidden" name="ease_of_learning" value="">
                    <div class="choice-item" data-value="非常不同意">非常不同意</div>
                    <div class="choice-item" data-value="不同意">不同意</div>
                    <div class="choice-item" data-value="普通">普通</div>
                    <div class="choice-item" data-value="同意">同意</div>
                    <div class="choice-item" data-value="非常同意">非常同意</div>
                </div>
                <div class="error-message hidden">
                    <img src="assets/warning_icon.svg" alt="Warning">
                    <span>這題忘記填嚕 (•ᴥ•)</span>
                </div>
            </div>

            <!-- Question 9 -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">9.</span>
                    <span class="question-title">新版 ATM 的按鈕顯示位置一致，即便在不同交易項目，也能按知名如何操作</span>
                </div>
                <div class="image-placeholder-box">
                    <img src="assets/q9_comparison.png" alt="Button Consistency" class="img-responsive">
                </div>
                <div class="choice-list horizontal">
                    <input type="hidden" name="consistency" value="">
                    <div class="choice-item" data-value="非常不同意">非常不同意</div>
                    <div class="choice-item" data-value="不同意">不同意</div>
                    <div class="choice-item" data-value="普通">普通</div>
                    <div class="choice-item" data-value="同意">同意</div>
                    <div class="choice-item" data-value="非常同意">非常同意</div>
                </div>
                <div class="error-message hidden">
                    <img src="assets/warning_icon.svg" alt="Warning">
                    <span>這題忘記填嚕 (•ᴥ•)</span>
                </div>
            </div>

            <!-- Question 10 -->
            <div class="question">
                <div class="question-header">
                    <span class="question-number">10.</span>
                    <span class="question-title">如果還有任何想對團隊分享的意見或建議，歡迎告訴我們！</span>
                </div>
                <div class="question-desc">(註：本次設計試行期間僅針對ATM滿意度分析，不包含硬體外觀、具體存放款流程⋯⋯等)</div>
                <textarea name="feedback" placeholder="歡迎分享您最寶貴的意見" class="feedback-textarea"></textarea>
            </div>

            <!-- Demographics Section -->
            <div class="demographics-section">
                <div class="question">
                    <div class="question-title">近三個月使用臺灣銀行 ATM 的頻率</div>
                    <div class="grid-choices">
                        <input type="hidden" name="usage_frequency" value="">
                        <div class="choice-item" data-value="每天至少 1 次">每天至少 1 次</div>
                        <div class="choice-item" data-value="每周 3 次以上">每周 3 次以上</div>
                        <div class="choice-item" data-value="每周 1-2 次">每周 1-2 次</div>
                        <div class="choice-item" data-value="每月 1-3 次">每月 1-3 次</div>
                        <div class="choice-item" data-value="平均一個月不到 1 次">平均一個月不到 1 次</div>
                        <div class="choice-item" data-value="近三個月未曾使用">近三個月未曾使用</div>
                    </div>
                    <div class="error-message hidden">
                        <img src="assets/warning_icon.svg" alt="Warning">
                        <span>這題忘記填嚕 (•ᴥ•)</span>
                    </div>
                </div>

                <div class="question">
                    <div class="question-title">您的年齡</div>
                    <div class="grid-choices">
                        <input type="hidden" name="age_range" value="">
                        <div class="choice-item" data-value="22 - 29 歲">22 - 29 歲</div>
                        <div class="choice-item" data-value="30 - 39 歲">30 - 39 歲</div>
                        <div class="choice-item" data-value="40 - 49 歲">40 - 49 歲</div>
                        <div class="choice-item" data-value="50 - 59 歲">50 - 59 歲</div>
                        <div class="choice-item" data-value="60 - 65 歲">60 - 65 歲</div>
                        <div class="choice-item" data-value="66 歲以上">66 歲以上</div>

                    </div>
                    <div class="error-message hidden">
                        <img src="assets/warning_icon.svg" alt="Warning">
                        <span>這題忘記填嚕 (•ᴥ•)</span>
                    </div>
                </div>
                <!-- 
                <div class="question">
                    <div class="question-title">您的員工編號（僅用於抽獎）</div>
                    <input type="text" name="employee_id" placeholder="請輸入您的臺灣銀行員工編號" class="emp-id-input">
                </div> 
                -->
            </div>

            <div class="submit-container">
                <button type="submit" class="submit-btn" id="submit-button">送出</button>
            </div>
        </form>
    </div>

    <section class="completion-page hidden" id="completion-page">
        <div class="completion-content">
            <h2 class="completion-title">表單已順利送出！</h2>
            <div class="completion-rewards">
                <h3>填寫完畢，有機會獲得</h3>
                <div class="reward-items">
                    <div class="reward-item">
                        <span class="reward-text">1000 元超商禮券</span>
                        <span class="reward-count">20 名</span>
                    </div>
                </div>
            </div>
            <div class="completion-image">
                <img src="assets/completion_illustration.png" alt="Completion Illustration">
            </div>
            <div class="completion-logo">
                <p>BANK OF TAIWAN</p>
            </div>
        </div>
    </section>

    <script>
        // Toggle between landing page and survey
        document.getElementById('start-survey-btn').addEventListener('click', function () {
            document.getElementById('landing-page').classList.add('hidden');
            document.getElementById('survey-form').classList.remove('hidden');
            window.scrollTo(0, 0);
        });

        // Question selection logic
        document.querySelectorAll('.rating-item, .choice-item').forEach(item => {
            item.addEventListener('click', function () {
                const parent = this.parentElement;
                parent.querySelectorAll('.rating-item, .choice-item').forEach(sibling => sibling.classList.remove('selected'));
                this.classList.add('selected');

                // Update hidden input if exists
                const hiddenInput = parent.querySelector('input[type="hidden"]');
                if (hiddenInput) {
                    hiddenInput.value = this.getAttribute('data-value') || this.innerText;
                }

                // Hide error message on selection
                const questionEl = this.closest('.question');
                if (questionEl) {
                    const errorMsg = questionEl.querySelector('.error-message');
                    if (errorMsg) errorMsg.classList.add('hidden');
                }
            });
        });

        // Checkbox limit logic
        const maxSelections = 3;
        const checkboxes = document.querySelectorAll('input[name="satisfied_features"]');

        checkboxes.forEach(checkbox => {
            checkbox.addEventListener('change', function (e) {
                const checkedCount = document.querySelectorAll('input[name="satisfied_features"]:checked').length;
                const questionEl = this.closest('.question');
                if (questionEl) {
                    const errorMsg = questionEl.querySelector('.error-message');
                    // Hide error if at least one selected
                    if (checkedCount > 0 && errorMsg) errorMsg.classList.add('hidden');
                }


                // If checking the box would exceed limit
                if (checkedCount > maxSelections) {
                    this.checked = false; // Prevent checking
                    // e.preventDefault(); // Sometimes needed for certain events, but change fires after.
                }

                updateCheckboxState();
            });
        });

        function updateCheckboxState() {
            const checkedCount = document.querySelectorAll('input[name="satisfied_features"]:checked').length;
            const allCheckboxes = document.querySelectorAll('input[name="satisfied_features"]');

            allCheckboxes.forEach(cb => {
                if (!cb.checked) {
                    if (checkedCount >= maxSelections) {
                        cb.disabled = true;
                        cb.parentElement.style.opacity = '0.5';
                        cb.parentElement.style.cursor = 'not-allowed';
                    } else {
                        cb.disabled = false;
                        cb.parentElement.style.opacity = '1';
                        cb.parentElement.style.cursor = 'pointer';
                    }
                }
            });
        }

        document.getElementById('survey-form').onsubmit = (e) => {
            e.preventDefault();

            // Reset errors
            document.querySelectorAll('.error-message').forEach(el => el.classList.add('hidden'));

            // Validation flag
            let isValid = true;
            let firstErrorElement = null;

            // Helper to show error
            const showError = (questionElement) => {
                if (!questionElement) return;
                const errorMsg = questionElement.querySelector('.error-message');
                if (errorMsg) {
                    errorMsg.classList.remove('hidden');
                }
                if (!firstErrorElement) {
                    firstErrorElement = questionElement;
                }
                isValid = false;
            };

            // Validate Rating (Q1)
            const ratingInput = document.querySelector('input[name="rating"]');
            if (ratingInput && !ratingInput.value) {
                showError(ratingInput.closest('.question'));
            }

            // Validate Single Choice Questions (Q2, Q3, Q4, Q6, Q7, Q8, Q9)
            const singleChoiceNames = ['easy_to_use', 'satisfaction_process', 'modernization', 'process_streamlining', 'info_mastery', 'ease_of_learning', 'consistency'];
            singleChoiceNames.forEach(name => {
                const input = document.querySelector(`input[name="${name}"]`);
                if (input && !input.value) {
                    const questionEl = input ? input.closest('.question') : null;
                    showError(questionEl);
                }
            });

            // Validate Checkboxes (Q5)
            const checkedBoxes = document.querySelectorAll('input[name="satisfied_features"]:checked');
            if (checkedBoxes.length === 0) {
                const checkboxList = document.querySelector('.checkbox-list');
                if (checkboxList) {
                    const questionEl = checkboxList.closest('.question');
                    showError(questionEl);
                }
            }

            // Validate Demographics (Usage, Age)
            const usage = document.querySelector('input[name="usage_frequency"]');
            if (usage && !usage.value) showError(usage.closest('.question'));

            const age = document.querySelector('input[name="age_range"]');
            if (age && !age.value) showError(age.closest('.question'));


            if (!isValid) {
                if (firstErrorElement) {
                    firstErrorElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
                return;
            }

            // Collect form data for console log
            const formData = new FormData(e.target);
            const data = {};
            formData.forEach((value, key) => {
                if (data[key]) {
                    if (!Array.isArray(data[key])) {
                        data[key] = [data[key]];
                    }
                    data[key].push(value);
                } else {
                    data[key] = value;
                }
            });
            console.log('問卷資料已準備好提交：', data);

            // If valid, switch to completion page
            document.getElementById('survey-form').classList.add('hidden');
            document.getElementById('completion-page').classList.remove('hidden');
            window.scrollTo(0, 0);
        };
    </script>
</body>

</html>